arrange((arr_delay)) %>%
summarise()
flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name) %>%
select(arr_delay, dest, name) %>%
arrange((arr_delay)) %>%
summarise()
flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
summarise()
flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
filter(arr_delay > 30) %>%
#group_by(arr_delay, dest, name) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
summarise()
flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
summarise()
flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
filter(arr_delay > 30) %>%
arrange(desc(arr_delay)) %>%
group_by(arr_delay, dest, name) %>%
summarise()
flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name) %>%
summarise()
flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name)
flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
#group_by(arr_delay, dest, name)
nycwthr <- weather %>%
filter(month == 6, day == 13, origin == "JFK") %>%
ggplot(aes(hour, precip)) + geom_point()
library(nycflights13)
library(dplyr)
library(ggplot2)
#?flights
#?airports
#?weather
### Question 1
```{r}
flights %>%
select(flight, year, month, day) %>%
summarise(flight)
flights %>%
group_by(flight, year, month, day) %>%
summarise(count = n())
flights %>%
group_by(flight, year, month, day) %>%
summarise(count = n())
flights %>%
select(flight, year, month, day) %>%
summarise(flight)
flights %>%
group_by(flight, year, month, day) %>%
summarise(count = n())
```{r}
flights %>%
group_by(flight, year, month, day) %>%
summarise(count = n())
flight_loc <- airports %>%
select(faa, name, lat, lon)
q2 <- left_join(flights, flight_loc, by = c(origin = 'faa'))
q2 %>% left_join(flight_loc, by = c(dest = 'faa')) %>%
rename(name_origin = name.x) %>%
rename(lat_origin = lat.x) %>%
rename(lon_origin = lon.x) %>%
rename(name_dest = name.y) %>%
rename(lon_dest = lon.y) %>%
rename(lat_dest = lat.y) %>%
select(origin, name_origin, lon_origin, lat_origin, dest, name_dest, lon_dest, lat_dest)
visibility <- weather %>%
select(origin, visib, time_hour)
flights %>%
select(origin, dep_delay, arr_delay, time_hour) %>%
left_join(visibility) #%>%
ggplot(aes(dep_delay, visib)) + geom_point()
q3 <- flights %>%
select(origin, dep_delay, arr_delay, time_hour) %>%
left_join(visibility) #%>%
ggplot(aes(dep_delay, visib)) + geom_point()
ggplot(q3, aes(dep_delay, visib)) + geom_point()
ggplot(q3, aes(arr_delay, visib)) + geom_point()
q3 <- flights %>%
select(origin, dep_delay, arr_delay, time_hour) %>%
left_join(visibility) %>%
e <- origin
q3 %>%
summarise(group_by(visib), mean_delay = mean(dep_delay)) %>%
ggplot(q3, aes(visib, mean_delay))
`rlang::last_error()`
q3 %>%
(group_by(visib), mean_delay = mean(dep_delay)) %>%
q3 %>%
summarise(group_by(visib), mean_delay = mean(dep_delay)) %>%
ggplot(q3, aes(visib, mean_delay))
rlang::last_error()
rlang::last_trace()
q3 %>%
summarise(group_by(visib), mean_delay = mean(dep_delay)) #%>%
str(q3)
q3a <- summarise(group_by(q3, visib), mean_del = mean(dep_delay))
q3 %>%
group_by(visib) %>%
mean_delay = mean(dep_delay) %>%
summarise()
ggplot(q3a, aes(visib, mean_del)) + geom_point()
View(q3)
View(q3a)
q3a <- summarise(group_by(q3, visib), mean_del = mean(dep_delay))
ggplot(q3a, aes(visib, mean_del)) + geom_point()
q3a <- summarise(group_by(q3, visib), mean_delay = mean(dep_delay))
ggplot(q3a, aes(visib, mean_delay)) + geom_point()
q3a <- summarise(group_by(q3, dep_delay), mean_visib = mean(q3$visib))
ggplot(q3a, aes(dep_delay, mean_visib)) + geom_point()
View(q3a)
q3 <- flights %>%
select(origin, dep_delay, arr_delay, time_hour) %>%
left_join(visibility)
q3 %>%
group_by(visib) %>%
mean_delay = mean(dep_delay) %>%
summarise()
q2 <- left_join(flights, flight_loc, by = c(dest = 'faa'))
q2 %>% left_join(flight_loc, by = c(dest = 'faa')) %>%
rename(name_origin = name.x) %>%
rename(lat_origin = lat.x) %>%
rename(lon_origin = lon.x) %>%
rename(name_dest = name.y) %>%
rename(lon_dest = lon.y) %>%
rename(lat_dest = lat.y) %>%
select(origin, name_origin, lon_origin, lat_origin, dest, name_dest, lon_dest, lat_dest)
q2 <- left_join(flights, flight_loc, by = c(orgin = 'faa'))
q2 <- left_join(flights, flight_loc, by = c(origin = 'faa'))
q2 %>% left_join(flight_loc, by = c(dest = 'faa')) %>%
rename(name_origin = name.x) %>%
rename(lat_origin = lat.x) %>%
rename(lon_origin = lon.x) %>%
rename(name_dest = name.y) %>%
rename(lon_dest = lon.y) %>%
rename(lat_dest = lat.y) %>%
select(origin, name_origin, lon_origin, lat_origin, dest, name_dest, lon_dest, lat_dest)
q3 <- flights %>%
select(origin, dep_delay, arr_delay, time_hour) %>%
left_join(visibility)
flight_dest <- airports %>%
select(faa, name)
flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name)
q4 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name)
?unique
q4 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name) %>%
unique(dest)
q4 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name) %>%
unique(dest, incomparables = FALSE)
q4 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name)
q4
q4 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name) %>%
unique(q4$dest, incomparables = FALSE)
count(q4$dest)
q4 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name) %>%
unique(q4$dest, incomparables = FALSE, fromLast = FALSE)
q4 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name) %>%
unique(q4$dest, fromLast = FALSE)
q4 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name) %>%
length(which(arr_delay > 30))
q4 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name) #%>%
View(q4)
q4 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name) %>%
length(which(arr_delay > 30))
q4 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
#group_by(arr_delay, dest, name) %>%
length(which(arr_delay > 30))
q4 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name) %>%
unique(q4$dest, fromLast = FALSE)
q4 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name)
q4
count(q4, vars = 'dest')
count_tot <- count(flights, vars = 'dest')
View(count_tot)
count_grtr <- count(q4, vars = 'dest')
View(count_grtr)
q4_2 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
group_by(arr_delay, dest, name)
count_tot <- count(q4_2, vars = 'dest')
View(count_tot)
q44 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(dest)
View(q44)
count_grtr2 <- count(q4, vars = 'dest')
View(count_grtr2)
q44 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay)
View(q44)
unique(q4$dest)
count(unique(q4$dest))
View(q4)
?summarise
q44 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay) %>%
summarise()
View(q44)
q4 <- flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name) %>%
summarise()
View(q4)
count_grtr2 <- count(q4, vars = 'dest')
View(count_grtr2)
unique(q4$dest)
weather %>%
filter(month == 6, day == 13, origin == "JFK") %>%
ggplot(aes(hour, precip)) + geom_point()
flights %>%
select(year, month, day, hour, dep_delay, arr_delay) %>%
filter(month == 6, day == 13) %>%
arrange(desc(dep_delay))
flights %>%
select(year, month, day, dep_delay, arr_delay) %>%
filter(month == 6, day == 13) %>%
arrange(desc(dep_delay))
weather %>%
filter(month == 6, day == 13, origin == "JFK" or dest == 'JFK') %>%
flights %>%
left_join(flight_dest, by = c(dest = 'faa')) %>%
select(arr_delay, dest, name) %>%
arrange(desc(arr_delay)) %>%
filter(arr_delay > 30) %>%
group_by(arr_delay, dest, name)
visibility <- weather %>%
select(origin, visib, time_hour)
q3 <- flights %>%
select(origin, dep_delay, arr_delay, time_hour) %>%
left_join(visibility)
q3 %>%
group_by(visib)
q3 %>%
group_by(visib) %>%
mutate(avg = mean(arr_delay))
str(flights)
q3 %>%
group_by(visib) %>%
mutate(avg = mean(arr_delay))
q3a <- summarise(group_by(q3, dep_delay), mean_visib = mean(q3$visib))
View(q3a)
q3a <- summarise(group_by(q3, dep_delay), mean_visib = mean(q3$visib))
View(q3a)
ggplot(q3a, aes(dep_delay, mean_visib)) + geom_point()
ggplot(q3, aes(arr_delay, visib)) + geom_point()
ggplot(q3, aes(arr_delay, visib)) + geom_bar()
ggplot(q3, aes(x = arr_delay, weight = visib)) + geom_bar()
ggplot(q3, aes(x = arr_delay, y = visib)) + geom_boxplot()
p <- ggplot(q3, aes(x = arr_delay, y = visib)) + geom_boxplot()
p
q3 <- flights %>%
select(origin, dep_delay, arr_delay, time_hour) %>%
left_join(visibility)
p <- ggplot(q3, aes(arr_delay)) + geom_boxplot()
p
p <- ggplot(q3, aes(arr_delay, visib)) + geom_boxplot()
p
ggplot(q3, aes(visib, arr_delay)) + geom_point()
ggplot(q3, aes(arr_delay, visib)) + geom_point()
q3a <- summarise(group_by(q3, dep_delay), mean_visib = mean(q3$visib))
q3a <- summarise(group_by(q3, dep_delay), mean_visib = mean(q3$visib))
ggplot(q3a, aes(dep_delay, mean_visib)) + geom_boxplot()
setwd("~/ds202/ds202_lab4")
library(dplyr)
library(dplyr)
library(ggplot2)
library(dplyr)
library(ggplot2)
library(readxl)
library(readxl)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(readxl)
library(tidyverse)
def <- read_excel('cyclonesFootball2020.xlsx', sheet = 'Defensive')
off <- read_excel('cyclonesFootball2020.xlsx', sheet = 'Offensive')
kikr <- read_excel('cyclonesFootball2020.xlsx', sheet = 'Kick Returns')
kik <- read_excel('cyclonesFootball2020.xlsx', sheet = 'Kicking')
bio <- read_excel('cyclonesFootball2020.xlsx', sheet = 'Biography')
def$Name <- factor(def$Name)
def$Opponent_Opponent <- factor(def$Opponent_Opponent)
off$Name <- factor(off$Name)
off$Opponent_Opponent <- factor(off$Opponent_Opponent)
defClean <- def %>%
mutate(Tackles_Solo=as.numeric(Tackles_Solo)) %>%
mutate(Tackles_ASST=as.numeric(Tackles_ASST)) %>%
mutate(Tackles_TFL=as.numeric(Tackles_TFL)) %>%
mutate(Tackles_Sack=as.numeric(Tackles_Sack)) %>%
mutate(Turnover_FF=as.numeric(Turnover_FF)) %>%
mutate(Turnover_FR=as.numeric(Turnover_FR)) %>%
mutate(Turnover_INT=as.numeric(Turnover_INT)) %>%
mutate(Pass_QBH=as.numeric(Pass_QBH)) %>%
mutate(Pass_PB=as.numeric(Pass_PB))
offClean <- off %>%
mutate(Receiving_REC=as.numeric(Receiving_REC)) %>%
mutate(Receiving_YDS=as.numeric(Receiving_YDS)) %>%
mutate(Receiving_TD=as.numeric(Receiving_TD)) %>%
mutate(Rushing_ATT=as.numeric(Rushing_ATT)) %>%
mutate(Rushing_YDS=as.numeric(Rushing_YDS)) %>%
mutate(Rushing_TD=as.numeric(Rushing_TD)) %>%
mutate(`Passing_CMP-ATT`=as.numeric(`Passing_CMP-ATT`)) %>%
mutate(Passing_YDS=as.numeric(Passing_YDS)) %>%
mutate(Passing_TD=as.numeric(Passing_TD)) %>%
mutate(Passing_INT=as.numeric(Passing_INT))
bioClean <- bio %>%
mutate(Weight=as.numeric(Weight))
#str(defClean)
#str(bioClean)
#str(offClean)
bioClean <- bioClean %>%
separate(Height, c('Height_feet', 'Height_inches')) %>%
mutate(Height_feet = as.integer(Height_feet),
Height_inches = as.integer(Height_inches)) %>%
mutate(Height = (Height_inches + (Height_feet * 12))) %>%
select(-Height_inches, -Height_feet)
bioClean <- bioClean %>%
separate(Height, c('Height_feet', 'Height_inches')) %>%
mutate(Height_feet = as.integer(Height_feet),
Height_inches = as.integer(Height_inches)) %>%
mutate(Height = (Height_inches + (Height_feet * 12))) %>%
select(-Height_inches, -Height_feet)
str(defClean)
str(offClean)
str(bioClean)
bioClean <- bio %>%
mutate(Weight=as.numeric(Weight))
offClean <- off %>%
mutate(Receiving_REC=as.numeric(Receiving_REC)) %>%
mutate(Receiving_YDS=as.numeric(Receiving_YDS)) %>%
mutate(Receiving_TD=as.numeric(Receiving_TD)) %>%
mutate(Rushing_ATT=as.numeric(Rushing_ATT)) %>%
mutate(Rushing_YDS=as.numeric(Rushing_YDS)) %>%
mutate(Rushing_TD=as.numeric(Rushing_TD)) %>%
mutate(`Passing_CMP-ATT`=as.numeric(`Passing_CMP-ATT`)) %>%
mutate(Passing_YDS=as.numeric(Passing_YDS)) %>%
mutate(Passing_TD=as.numeric(Passing_TD)) %>%
mutate(Passing_INT=as.numeric(Passing_INT))
bioClean <- bio %>%
mutate(Weight=as.numeric(Weight))
bioClean <- bioClean %>%
separate(Height, c('Height_feet', 'Height_inches')) %>%
mutate(Height_feet = as.integer(Height_feet),
Height_inches = as.integer(Height_inches)) %>%
mutate(Height = (Height_inches + (Height_feet * 12))) %>%
select(-Height_inches, -Height_feet)
str(bioClean)
ggplot(data = offClean, aes(value)) +
geom_histogram(color = "steelblue") +
labs(title = "Distribution of Offensive Statistics",
y = "Number of Occurrences", x = "Value of Statistic") +
facet_wrap(~ stat)
bioClean <- bioClean %>%
separate(Hometown, c('Hometown_city', 'Hometown_state'), sep = ', ')
bioClean %>%
select(Hometown_state) %>%
group_by(Hometown_state) %>%
summarise(count = n())
ggplot(data = offClean, aes(value)) +
geom_histogram(color = "steelblue") +
labs(title = "Distribution of Offensive Statistics",
y = "Number of Occurrences", x = "Value of Statistic") +
facet_wrap(~ stat)
ggplot(data = offClean, aes(value)) +
geom_histogram(color = "steelblue") +
labs(title = "Distribution of Offensive Statistics",
y = "Number of Occurrences", x = "Value of Statistic") +
facet_wrap(~ stat)
offClean <- offClean %>%
pivot_longer(cols = Receiving_REC:Passing_INT, names_to = "stat")
ggplot(data = offClean, aes(value)) +
geom_histogram(color = "steelblue") +
labs(title = "Distribution of Offensive Statistics",
y = "Number of Occurrences", x = "Value of Statistic") +
facet_wrap(~ stat)
View(offClean)
okoff <- offClean %>%
filter(Opponent_Opponent == 'Oklahoma')
okoff
okoff <- offClean %>%
filter(Opponent_Opponent == 'Oklahoma') %>%
filter(stat == 'Receiving_YDS')
okoff
okoff <- offClean %>%
filter(Opponent_Opponent == 'Oklahoma') %>%
filter(stat == 'Receiving_YDS')
okoff
oroff <- offClean %>%
filter(Opponent_Opponent == "Oregon") %>%
filter(stat == 'Receiving_YDS')
oroff
oroff %>%
full_join(okoff)
plot(oroff$value, okoff$value)
ggplot(aes(oroff$value, okoff$value))
ggplot(oroff, okoff, aes(oroff$value, okoff$value))
